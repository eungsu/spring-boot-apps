# 게시글 목록 조회

## 구성파일
#### `pages/posts/ListPage.jsx`
- `/posts/list` URL에 매핑되는 페이지다.
- 주요 내용
  - 게시글 목록을 표현하는 `PostList.jsx` 컴포넌트를 포함한다.
  - 페이지네이션을 표현하는 `Pagination.jsx` 컴포넌트를 포함한다.
  - 게시글목록정보, 페이징정보, 현재 페이지번호를 `State`로 관리한다.
  - 페이지번호가 변경될 때마다 게시글목록정보, 페이징정보를 백엔드 API에서 데이터를 가져오는 `사이트 이펙트함수`를 실행한다.
  - `PostList`컴포넌트에 게시글목록정보를 `Props`로 전달한다.
  - `Pagination` 컴포넌트에 페이징정보, 이벤트핸들러함수를 `Props`로 전달한다.
#### `components/posts/PostList.jsx`
- 게시글 목록정보를 표현하는 컴포넌트다.
- 주요 내용
  - `props`로 `ListPage`가 전달한 게시글 목록정보를 받는다.
  - 배열객체의 `map()` 메소드를 이용해서 게시글 목록을 렌더링한다.
  - `<Link />`를 이용해서 게시글 제목을 클릭하면 게시글 상세페이지로 이동한다.
#### `components/Pagination.jsx`
- 페이지네이션을 표현하는 컴포넌트다.
- 주요 내용
  - `props`로 'ListPage'가 전달한 페이징정보, 이벤트핸들러함수를 받는다.
  - 페이징정보를 이용해서 페이지네이션을 렌더링한다.
  - 페이지번호 클릭시 전달받은 이벤트핸들러함수를 실행한다.
#### `api/postApi.js`
- `axios`를 사용하여 백엔드 API와 통신한다.
- 주요 내용
  - 게시글 목록 요청 함수 제공

## 코드 구현하기
### 백엔드 API와 연동
1. `api/postApi.js` 페이지번호를 서버로 보내고 게시글 목록과 페이징정보를 응답으로 받기
   - 요청방식: `GET`
   - 요청URI: `/api/posts`
   - 요청파라미터: `?page=페이지번호`
   - 요청헤더: `Authorization:Bearer eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiIxIiwiYXV0aG9yaXRpZXMiOiJST0xFX1VTRVIiLCJpYXQiOjE3NTM5MjcyNjMsImV4cCI6MTc1MzkyODE2M30.u6uK9aM02ocDeYgMlb6T98Q0gMvs6bGwrexv0ebR18hFbXO_LzBEYfd1Yyk_HKs1d7mRwJ9jqraGDi0rc-7sog`
     - `api/axiosInstance.js`에서 HTTP 요청시 자동으로 요청헤더에 JWT 엑세스토큰을 추가한다.
   - 요청데이터: 없음
   - 응답데이터:
     ```json
     {
       "stateCode":200,
       "message":"요청이 성공적으로 처리되었습니다."
       "data":{
         "items": [
           {
             "postNo":5,
             "title":"게시글 작성 연습2",
             "commentCnt":"3",
             "createdDate":"2025-07-31T11:00:55.956912",
             "name":"홍길동"
           },
           {
             "postNo":4,
             "title":"게시글 작성 연습1",
             "commentCnt":"1",
             "createdDate":"2025-07-31T11:00:55.956912",
             "name":"홍길동"
           },
           
         ],
         "paging": {
           "page":1,
           "totalRows":12,
           "totalPage":2,
           "beginPage":1,
           "endPage":3,
           "prevPage":0,
           "nextPage":2,
           "first":true,
           "last":false
         }
       }    
     }
     ```
   - 주요 내용
     ```javascript
     export const fetchPosts = async (page = 1) => {
       const response = await axios.get(`${API_BASE}?page=${page}`);
       return response.data;
     }
     ```
### 게시글 목록 컴포넌트
1. `PostList` 컴포넌트 작성하기
    ```javascript
    const PostList = ({ posts }) => {
      // 코드 생략
    }
    export default PostList;
    // posts는 props로 전달받은 게시글 목록 정보다.
    ```
2. 게시글 목록 렌더링하기
    ```jsx
    <tbody>
      {posts.length === 0 ? (
        <tr>
          <td colspan="5" className="text-center">게시글이 없습니다.</td>
        </tr>
      ) : (
        posts.map(post => (
          <tr key={post.postNo}>
            <td>{post.postNo}</td>
            <td><Link to={`/posts/detail/${post.postNo}`}>${post.title}</Link></td>
            <td>{post.name}</td>
            <td>{new Date(post.createdDate).toLocaleString()}</td>
            <td>{post.commentCnt}</td>
          </tr>
        ))
      )}
    </tbody>
    ```
### 페이지네이션 컴포넌트
1. `Pagination` 컴포넌트 작성하기
    ```javascript
    const Pagination = ({ paging, onPageChange }) => {
      // 코드 생략
    }
    export default Pagination;
    // paging과 onPageChange는 props로 전달받은 페이징정보와 이벤트핸들러함수다.
    ```
2. 페이지번호 클릭시 실행되는 이벤트 핸들러 작성하기
    ```javascript
    const handleClick = (pageNo) => {
      // 클릭한 페이지번호와 현재 페이지번호가 다를 때만 부모 컴포넌트의 onPageChange()함수를 호출한다.
      if (pageNo !== paging.page) {
        onPageChange(pageNo);
      }
    }
    ```
3. 표시할 페이지번호 생성하기
    ```javascript
    // 페이지번호 렌더링에 활용되는 페이지번호를 시작페이지번호와 끝페이지번호를 활용해서 생성한다.
    const pageNumbers = [];
    for (let i = paging.beginPage; i<= paging.endPage; i++) {
      pageNumbers.push(i);
    }
    ```
4. 페이지네이션 렌더링하기
    ```jsx
    <nav>
      <ul className="pagination">
        {/* 첫 페이지가 아닌 경우 이전 버튼 활성화하기 */}
        <l className={`page-item ${paging.first ? 'disabled' : ''}`}i>
          <button className="page-link" onClick={() => handleClick(paging.prevPage)}>이전</button>
        </li>
    
        {/* 생성한 페이지번호배열로 페이지번호 버튼 렌더링하기 */}
        {pageNumbers.map(pageNo => (
          <li key={pageNo} className={`page-item ${pageNo === paging.page ? 'active' : ''}`}>
            <button className="page-link" onClick={() => handleClick(pageNo)}>{pageNo}</button>
          </li>
    
        {/* 마지막 페이지가 아닌 경우 다음 버튼 활성화하기 */}
        <l className={`page-item ${paging.last ? 'disabled' : ''}`}i>
          <button className="page-link" onClick={() => handleClick(paging.nextPage)}>다음</button>
        </li>
        ))}
      </ul>
    </nav>
    ```
### 게시글 목록 페이지 작성하기
1. `ListPage` 작성하기
    ```javascript
    const ListPage = () => {
      // 코드 생략
    }
    export default ListPage;
    ```
2. `useState()`로 게시글 목록, 페이징정보, 현재 페이지번호 상태관리하기
    ```javascript
    // 게시글목록 정보 상태관 리하기
    const [posts, setPosts] = useState([]);
    // 페이징 정보 상태 관리하기
    const [paging, setPaging] = useState({});
    // 현재 페이지번호 상태 관리하기
    const [page, setPage] = useState(1);
    ```
3. 현재 페이지번호에 맞는 게시글목록, 페이징 정보를 조회하는 메소드 작성하기
    ```javascript
    const getPosts = async (pageNo) => {
      try {
        // response는 백엔드 서버가 보낸 응답데이터를 표현하는 객체다.
        const response = await fetchPosts(pageNo);
        setPosts(response.data.items);
        setPaging(response.data.paging);
      } catch (error) {
        // 코드 생략
      }
    }
    ```
4. `useEffect()`로 페이지번호가 변경될 때마다 위에서 정의한 getPosts()메소드를 호출하기
    ```javascript
    useEffect(() => {
      getPosts(page);
    }, [page]);
    ```
5. `PageContainer`, `PostList`, `Pagination` 컴포넌트 포함하고, `props`로 각 컴포넌트에 데이터 전달하기
    ```jsx
    return (
      <PageContainer title="게시글 목록">
        <PostList posts={posts} />
        <Pagination paging={paging} onPageChange={setPage} />
      </PageContainer>
    );
    ```
